#ifndef _MIPS32_H_
#define _MIPS32_H_

#include "bitops.h"

/*
refrence:
https://s3-eu-west-1.amazonaws.com/downloads-mips/documents/MD00086-2B-MIPS32BIS-AFP-6.06.pdf
*/

char *mips32_regname[32] = {
	"zero", "at", "v0", "v1", "a0", "a1", "a2", "a3", "t0", "t1", "t2",
	"t3",	"t4", "t5", "t6", "t7", "s0", "s1", "s2", "s3", "s4", "s5",
	"s6",	"s7", "t8", "t9", "k0", "k1", "gp", "sp", "fp", "ra",
};

char *mips32_opcode[64] = {
	[0] = "special",   [1] = "regimm", [2] = "j",	   [3] = "jal",
	[4] = "beq",	   [5] = "bne",	   [6] = "blez",   [7] = "bgtz",
	[8] = "addi",	   [9] = "addiu",  [10] = "slti",  [11] = "sltiu",
	[12] = "andi",	   [13] = "ori",   [14] = "xori",  [15] = "lui",
	[16] = "cop0",	   [17] = "cop1",  [18] = "cop2",  [19] = "cop1x",
	[20] = "beql",	   [21] = "bnel",  [22] = "blezl", [23] = "bgtzl",
	[24] = "pop30",	   [25] = "",	   [26] = "",	   [27] = "",
	[28] = "special2", [29] = "jalx",  [30] = "msa",   [31] = "special3",
	[32] = "lb",	   [33] = "lh",	   [34] = "lwl",   [35] = "lw",
	[36] = "lbu",	   [37] = "lhu",   [38] = "lwr",   [39] = "",
	[40] = "sb",	   [41] = "sh",	   [42] = "swl",   [43] = "sw",
	[44] = "",	   [45] = "",	   [46] = "swr",   [47] = "cache",
	[48] = "ll",	   [49] = "lwc",   [50] = "lwc2",  [51] = "pref",
	[52] = "",	   [53] = "ldc1",  [54] = "ldc2",  [55] = "",
	[56] = "sc",	   [57] = "swc1",  [58] = "swc2",  [59] = "pcrel",
	[60] = "",	   [61] = "sdc1",  [62] = "sdc2",  [63] = "",
};

char *mips32_special_func[64] = {
	[0] = "sll",	  [1] = "movci",   [2] = "srl",	   [3] = "sra",
	[4] = "sllv",	  [5] = "lsa",	   [6] = "srlv",   [7] = "srav",
	[8] = "jr",	  [9] = "jalr",	   [10] = "movz",  [11] = "movn",
	[12] = "syscall", [13] = "break",  [14] = "sdbbp", [15] = "sync",
	[16] = "mfhi",	  [17] = "mthi",   [18] = "mflo",  [19] = "mtlo",
	[20] = "",	  [21] = "",	   [22] = "",	   [23] = "",
	[24] = "mult",	  [25] = "multu",  [26] = "div",   [27] = "divu",
	[28] = "",	  [29] = "",	   [30] = "",	   [31] = "",
	[32] = "add",	  [33] = "addu",   [34] = "sub",   [35] = "subu",
	[36] = "and",	  [37] = "or",	   [38] = "xor",   [39] = "nor",
	[40] = "",	  [41] = "",	   [42] = "slt",   [43] = "sltu",
	[44] = "",	  [45] = "",	   [46] = "",	   [47] = "",
	[48] = "tge",	  [49] = "tgeu",   [50] = "tlt",   [51] = "tltu",
	[52] = "teq",	  [53] = "seleqz", [54] = "tne",   [55] = "selnez",
	[56] = "",	  [57] = "",	   [58] = "",	   [59] = "",
	[60] = "",	  [61] = "",	   [62] = "",	   [63] = "",
};

char *mips32_regimm_rt[32] = {
	[0] = "bltz",	 [1] = "bgez",	  [2] = "bltzl",    [3] = "bgezl",
	[4] = "",	 [5] = "",	  [6] = "dahi",	    [7] = "",
	[8] = "tgei",	 [9] = "tgeiu",	  [10] = "tlti",    [11] = "tltiu",
	[12] = "teqi",	 [13] = "",	  [14] = "tnei",    [15] = "",
	[16] = "bltzal", [17] = "bgezal", [18] = "bltzall", [19] = "bgezall",
	[20] = "",	 [21] = "",	  [22] = "",	    [23] = "sigrie",
	[24] = "",	 [25] = "",	  [26] = "",	    [27] = "",
	[28] = "",	 [29] = "",	  [30] = "dati",    [31] = "synci",
};

char *mips32_special2_func[64] = {
	[0] = "madd", [1] = "maddu", [2] = "mul", [3] = "",
	[4] = "msub", [5] = "msubu", [6] = "",	  [7] = "",
	[8] = "",     [9] = "",	     [10] = "",	  [11] = "",
	[12] = "",    [13] = "",     [14] = "",	  [15] = "",
	[16] = "",    [17] = "",     [18] = "",	  [19] = "",
	[20] = "",    [21] = "",     [22] = "",	  [23] = "",
	[24] = "",    [25] = "",     [26] = "",	  [27] = "",
	[28] = "",    [29] = "",     [30] = "",	  [31] = "",
	[32] = "clz", [33] = "clo",  [34] = "",	  [35] = "",
	[36] = "",    [37] = "",     [38] = "",	  [39] = "",
	[40] = "",    [41] = "",     [42] = "",	  [43] = "",
	[44] = "",    [45] = "",     [46] = "",	  [47] = "",
	[48] = "",    [49] = "",     [50] = "",	  [51] = "",
	[52] = "",    [53] = "",     [54] = "",	  [55] = "",
	[56] = "",    [57] = "",     [58] = "",	  [59] = "",
	[60] = "",    [61] = "",     [62] = "",	  [63] = "sdbbp",
};

char *mips32_special3_func[64] = {
	[0] = "ext",	[1] = "",	[2] = "",      [3] = "",
	[4] = "ins",	[5] = "",	[6] = "",      [7] = "",
	[8] = "",	[9] = "",	[10] = "",     [11] = "",
	[12] = "",	[13] = "",	[14] = "",     [15] = "",
	[16] = "",	[17] = "",	[18] = "",     [19] = "",
	[20] = "",	[21] = "",	[22] = "",     [23] = "",
	[24] = "",	[25] = "lwle",	[26] = "lwre", [27] = "cachee",
	[28] = "sbe",	[29] = "she",	[30] = "sce",  [31] = "swe",
	[32] = "bshfl", [33] = "swle",	[34] = "swre", [35] = "prefe",
	[36] = "",	[37] = "cache", [38] = "sc",   [39] = "",
	[40] = "lbue",	[41] = "lhue",	[42] = "",     [43] = "",
	[44] = "lbe",	[45] = "lhe",	[46] = "lle",  [47] = "lwe",
	[48] = "",	[49] = "",	[50] = "",     [51] = "",
	[52] = "",	[53] = "pref",	[54] = "ll",   [55] = "",
	[56] = "",	[57] = "",	[58] = "",     [59] = "rdhwr",
	[60] = "",	[61] = "",	[62] = "",     [63] = "",
};

char *mips32_cop0_rs[32] = {
	[0] = "mfc0", [1] = "",	   [2] = "mfh",	    [3] = "",
	[4] = "mtc0", [5] = "",	   [6] = "mth",	    [7] = "",
	[8] = "",     [9] = "",	   [10] = "rdpgpr", [11] = "mfmc0",
	[12] = "",    [13] = "",   [14] = "wrpgpr", [15] = "",
	[16] = "c0",  [17] = "c0", [18] = "c0",	    [19] = "c0",
	[20] = "c0",  [21] = "c0", [22] = "c0",	    [23] = "c0",
	[24] = "c0",  [25] = "c0", [26] = "c0",	    [27] = "c0",
	[28] = "c0",  [29] = "c0", [30] = "c0",	    [31] = "c0",
};

#define MIPS32_GET_OP(instr) (extract32((instr), 26, 6))
#define MIPS32_GET_RS(instr) (extract32((instr), 21, 5))
#define MIPS32_GET_RT(instr) (extract32((instr), 16, 5))
#define MIPS32_GET_RD(instr) (extract32((instr), 11, 5))
#define MIPS32_GET_SH(instr) (extract32((instr), 6, 5))
#define MIPS32_GET_FN(instr) (extract32((instr), 0, 6))
#define MIPS32_GET_DT(instr) (extract32((instr), 0, 26))
#define MIPS32_GET_IM(instr) (extract32((instr), 0, 16))
#define MIPS32_GET_SEL(instr) (extract32((instr), 0, 3))

#endif
